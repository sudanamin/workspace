package com.example.sudan.util;



import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.UnsupportedEncodingException;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import com.example.sudan.adapters.ViewPagerAdapter;

import android.app.Activity;
import android.os.AsyncTask;
import android.util.Log;
import android.widget.GridView;
import com.example.sudan.MainActivity;
public  class getTabsName extends AsyncTask<String, Void, JSONObject> {

   
    static InputStream is = null;
	static JSONObject jObj = null;
	static String json = "";

	ViewPagerAdapter adapter;
    GridView gridView;
    String sublist[];
	String catg_name[]= {"Catg 1","Catg 2","Catg 3","Catg 4"};
	String catg_descp[]= {"Catg 1","Catg 2","Catg 3","Catg 4"};
	String hash_tag[];
	Activity activity;
	//Integer[] images;
	String tabsname[];
	String ids[];
	String urls[];
	String imageUrls[];
	 String TAG_tabs = "tabsName";
	private static final String TAG_NAME = "tname";
	private static final String TAG_url = "url";
	private static final String TAG_ID = "id";
	
	
	JSONArray tabs = null;
	public String[] tabsN = { "amin ", " asdf ", " sdf ", " sdf " };;
	
        public getTabsName(  Activity activity){
		
		//this.adapter = adapter;
	//	this.gridView = gridView;
		this.activity = activity;
	//	this.TAG_tabs = arrofjson;
		
		
		}
	
	 @Override
    protected void onPreExecute() {
        super.onPreExecute();

    }

    @Override
    protected JSONObject doInBackground(String...  params) {


         String urll = params[0];
    	// Making HTTP request
    	try {
    		// defaultHttpClient
    		DefaultHttpClient httpClient = new DefaultHttpClient();
    		HttpPost httpPost = new HttpPost(urll);

    		HttpResponse httpResponse = httpClient.execute(httpPost);
    		HttpEntity httpEntity = httpResponse.getEntity();
    		is = httpEntity.getContent();			

    	} catch (UnsupportedEncodingException e) {
    		e.printStackTrace();
    	} catch (ClientProtocolException e) {
    		e.printStackTrace();
    	} catch (IOException e) {
    		e.printStackTrace();
    	}
    	
    	try {
    		BufferedReader reader = new BufferedReader(new InputStreamReader(
    				is, "iso-8859-1"), 8);
    		StringBuilder sb = new StringBuilder();
    		String line = null;
    		while ((line = reader.readLine()) != null) {
    			sb.append(line + "\n");
    		}
    		//reader.reset();
    		//is.reset();
    		is.close();
    		json = sb.toString();
    	} catch (Exception e) {
    		Log.e("Buffer Error", "Error converting result " + e.toString());
    	}

    	// try parse the string to a JSON object
    	try {
    		jObj = new JSONObject(json);
    	} catch (JSONException e) {
    		Log.e("JSON Parser", "Error parsing data " + e.toString());
    	}

    	// return JSON String
    	return jObj;

    }
    

    @Override
    protected void onPostExecute(JSONObject result) 
    {
        super.onPostExecute(result);
        
    
		try {
			// Getting Array of Contacts
			tabs = result.getJSONArray(TAG_tabs);
			tabsname= new String[tabs.length()];
			
			 
			
			// looping through All Contacts
			for(int i = 0; i < tabs.length(); i++){
		
				
				JSONObject c = tabs.getJSONObject(i);
				
				// Storing each json item in variable
			
			    
				String name = c.getString(TAG_NAME);
				tabsname[i]= name;
				
		
				
			
				
			}
		} catch (JSONException e) {
			e.printStackTrace();
		}
		tabsN = tabsname;
		Log.d("tabsN", tabsN[0]);
		System.out.println(tabsN);
	    //settadapter(tabsname);
		//gettabs();
	//.	gettabs(tabsname);
	/*	int Numboftabs = tabsname.length;
		CharSequence Titles[];
		Titles = tabsname;
		// FragmentManager fm = this.activity.FragmentManager();
		
		adapter = new ViewPagerAdapter(getSupportFragmentManager(), Titles,
				Numboftabs);
		*/
      //  adapter=new ViewPagerAdapter( this.activity, urls,tabsname,ids);
     //   gridView.setAdapter(adapter);

        

       
        }
    
   public String[] gettabs(){
    	//String tabsName[] = tabsname;
    	return tabsN;
    }
  
}